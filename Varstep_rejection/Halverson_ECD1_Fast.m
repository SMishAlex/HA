h=h*0.5;

$D1
x[0]=(x[0]+h*(-4*(x[1]+x[2])-x[1]*x[1]))/(1+b[0]*h);
x[1]=(x[1]+h*(-4*(x[0]+x[2])-x[2]*x[2]))/(1+b[1]*h);
x[2]=(x[2]+h*(-4*(x[1]+x[0])-x[0]*x[0]))/(1+b[2]*h);

//cromer 2
x[2]=x[2]+h*(-b[0]*x[2]-4*(x[1]+x[0])-x[0]*x[0]);
x[1]=x[1]+h*(-b[1]*x[1]-4*(x[0]+x[2])-x[2]*x[2]);
x[0]=x[0]+h*(-b[2]*x[0]-4*(x[1]+x[2])-x[1]*x[1]);

//IMP
float J[3][3];

J[0][0] = -b[0]; 
J[0][1] = -1*(4+2*x[1]); 
J[0][2] = -4; 

J[1][0] = -4; 
J[1][1] = -b[1];
J[1][2] = -1*(4+2*x[2]);

J[2][0] = -1*(4+2*x[0]); 
J[2][1] = -4;
J[2][2] = -b[2];


float w[3][4], Z[3], a[3], Zn[3], dz;
float tol;
int k; int i; int j; float t; float d;
tol = 1e-14;
int nnewtmax = 3, nnewt;
dz = 2e-13;
nnewt = 0;

Z[0] = x[0]; Z[1] = x[1]; Z[2] = x[2];
while ( (dz > tol) && (nnewt < nnewtmax)){
	for(i=0;i<3;i++)
	{
		for(j=0;j<3;j++)
		{
			if (i==j)
			w[i][j]=1 - 0.5*h*J[i][j];
			else
			w[i][j]= - 0.5*h*J[i][j];
		}
	}



	a[0] = 0.5*(x[0] + Z[0]);
	a[1] = 0.5*(x[1] + Z[1]);
	a[2] = 0.5*(x[2] + Z[2]);
	
	w[0][3]= -Z[0]+x[0]+h*(-b[0]*a[0]-4*(a[1]+a[2])-a[1]*a[1]);
	w[1][3]= -Z[1]+x[1]+h*(-b[1]*a[1]-4*(a[0]+a[2])-a[2]*a[2]);
	w[2][3]= -Z[2]+x[2]+h*(-b[2]*a[2]-4*(a[1]+a[0])-a[0]*a[0]);
	
	
	for(k = 0; k <= 1; k++){
		int l = k;
	
		for( i = k+1; i<= 2; i++){
			if( abs(w[i][k]) > abs(w[l][k]) ){
			l = i;
			}
		}
		if (l != k){
			for( j = 0; j <= 3; j++){
				if ((j == 0) || (j >= k)){
					t = w[k][j];
					w[k][j] = w[l][j];
					w[l][j] = t;
				}
			}
		}	

		d = 1.0 / w[k][k];
		for( i=(k+1); i <=(2); i++){
			if (w[i][k] == 0){
				continue;
			}
			t = w[i][k] * d;
			for ( j = k; j <= (3); j++) {
				if (w[k][j] != 0){
					w[i][j] = w[i][j] - t * w[k][j];
				}
			}
		}
	}
	for( i=(3); i >= 2; i--){
		for( j=1; j <= i-1; j++){
			t = w[i - j - 1][i - 1]/w[ i -1][i - 1];
			w[i-j - 1][ 3] = w[i-j -1][3] - t*w[i - 1][ 3];
		}
		w[i-1][ 3] = w[i - 1][3]/w[ i -1][i - 1];
	}
	w[0][3] = w[0][3]/w[0][0];
	Zn[0] = Z[0]+ w[0][3];
	Zn[1] = Z[1]+ w[1][3];
	Zn[2] = Z[2]+ w[2][3];
	
	dz = ( (Zn[0] - Z[0])**2 + (Zn[1] - Z[1])**2 + (Zn[2] - Z[2])**2 )**0.5;
	Z[0] = Zn[0];
	Z[1] = Zn[1];
	Z[2] = Zn[2];

	nnewt ++;
}

x[0] = Zn[0];
x[1] = Zn[1];
x[2] = Zn[2];